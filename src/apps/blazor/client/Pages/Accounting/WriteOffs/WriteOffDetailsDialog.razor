@inject IClient Client
@inject ISnackbar Snackbar

<MudDialog>
    <DialogContent>
        @if (_loading)
        {
            <MudProgressCircular Indeterminate Color="Color.Primary" />
        }
        else if (_writeOff is null)
        {
            <MudAlert Severity="Severity.Warning">Write-Off not found.</MudAlert>
        }
        else
        {
            <MudStack Spacing="3">
                <MudText Typo="Typo.h6">Write-Off Details</MudText>
                <MudDivider />
                
                <MudGrid>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Reference Number</MudText>
                        <MudText>@_writeOff.ReferenceNumber</MudText>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Write-Off Date</MudText>
                        <MudText>@_writeOff.WriteOffDate.ToShortDateString()</MudText>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Type</MudText>
                        <MudText>@_writeOff.WriteOffType</MudText>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Amount</MudText>
                        <MudText>@_writeOff.Amount.ToString("C2")</MudText>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Recovered Amount</MudText>
                        <MudText>@_writeOff.RecoveredAmount.ToString("C2")</MudText>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Is Recovered</MudText>
                        <MudChip T="string" Color="@(_writeOff.IsRecovered ? Color.Success : Color.Default)" Size="Size.Small">
                            @(_writeOff.IsRecovered ? "Yes" : "No")
                        </MudChip>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Status</MudText>
                        <MudChip T="string" Color="Color.Info" Size="Size.Small">@_writeOff.Status</MudChip>
                    </MudItem>
                    <MudItem xs="12" sm="6">
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">Approval Status</MudText>
                        <MudChip T="string" Color="@GetApprovalColor(_writeOff.ApprovalStatus)" Size="Size.Small">
                            @_writeOff.ApprovalStatus
                        </MudChip>
                    </MudItem>
                    @if (!string.IsNullOrWhiteSpace(_writeOff.CustomerName))
                    {
                        <MudItem xs="12" sm="6">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Customer</MudText>
                            <MudText>@_writeOff.CustomerName</MudText>
                        </MudItem>
                    }
                    @if (!string.IsNullOrWhiteSpace(_writeOff.InvoiceNumber))
                    {
                        <MudItem xs="12" sm="6">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Invoice</MudText>
                            <MudText>@_writeOff.InvoiceNumber</MudText>
                        </MudItem>
                    }
                    @if (!string.IsNullOrWhiteSpace(_writeOff.Reason))
                    {
                        <MudItem xs="12">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Reason</MudText>
                            <MudText>@_writeOff.Reason</MudText>
                        </MudItem>
                    }
                    @if (!string.IsNullOrWhiteSpace(_writeOff.Description))
                    {
                        <MudItem xs="12">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Description</MudText>
                            <MudText>@_writeOff.Description</MudText>
                        </MudItem>
                    }
                    @if (!string.IsNullOrWhiteSpace(_writeOff.Notes))
                    {
                        <MudItem xs="12">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Notes</MudText>
                            <MudText>@_writeOff.Notes</MudText>
                        </MudItem>
                    }
                    @if (!string.IsNullOrWhiteSpace(_writeOff.ApprovedBy))
                    {
                        <MudItem xs="12" sm="6">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Approved By</MudText>
                            <MudText>@_writeOff.ApprovedBy</MudText>
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudText Typo="Typo.subtitle2" Color="Color.Primary">Approved Date</MudText>
                            <MudText>@_writeOff.ApprovedDate?.ToShortDateString()</MudText>
                        </MudItem>
                    }
                </MudGrid>
            </MudStack>
        }
    </DialogContent>
    <DialogActions>
        <MudButton Variant="Variant.Filled" Color="Color.Secondary" OnClick="@(() => Cancel())">Close</MudButton>
    </DialogActions>
</MudDialog>


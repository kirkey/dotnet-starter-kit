@namespace FSH.Starter.Blazor.Client.Pages.Hr.EmployeePayComponents

<MudDialog>
    <DialogContent>
        <MudStack Spacing="3">
            <MudText Typo="Typo.h6">Employee Pay Components Help</MudText>

            <MudText Typo="Typo.body2" Class="mb-2">
                Employee Pay Components assign specific pay components to individual employees with custom rates and amounts.
            </MudText>

            <MudExpansionPanels Elevation="@_preference.Elevation">
                <MudExpansionPanel Text="Assignment Types">
                    <MudList T="string" Dense="true">
                        <MudListItem Icon="@Icons.Material.Filled.Add">
                            <b>Addition</b> - Add to base pay
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Remove">
                            <b>Deduction</b> - Subtract from pay
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.SwapHoriz">
                            <b>Override</b> - Replace default calculation
                        </MudListItem>
                    </MudList>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Amount Options">
                    <MudList T="string" Dense="true">
                        <MudListItem Icon="@Icons.Material.Filled.Money">
                            <b>Fixed Amount</b> - Specific dollar value
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Percent">
                            <b>Custom Rate</b> - Percentage-based rate
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Functions">
                            <b>Custom Formula</b> - Calculated value (e.g., BasicPay * 0.10)
                        </MudListItem>
                    </MudList>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Frequency">
                    <MudList T="string" Dense="true">
                        <MudListItem Icon="@Icons.Material.Filled.Repeat">
                            <b>Recurring</b> - Applied every pay period
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.LooksOne">
                            <b>One-Time</b> - Single payment on specific date
                        </MudListItem>
                    </MudList>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Common Uses">
                    <MudList T="string" Dense="true">
                        <MudListItem Icon="@Icons.Material.Filled.MonetizationOn">
                            Special allowances for specific employees
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Stars">
                            Performance bonuses
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.LocationOn">
                            Location-based adjustments
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.School">
                            Education/training reimbursements
                        </MudListItem>
                    </MudList>
                </MudExpansionPanel>
            </MudExpansionPanels>
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="Close">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter]
    IMudDialogInstance MudDialog { get; set; } = null!;

    private ClientPreference _preference = new();

    protected override async Task OnInitializedAsync()
    {
        if (await ClientPreferences.GetPreference() is ClientPreference preference)
        {
            _preference = preference;
        }

        Courier.SubscribeWeak<NotificationWrapper<ClientPreference>>(wrapper =>
        {
            _preference.Elevation = ClientPreference.SetClientPreference(wrapper.Notification);
            _preference.BorderRadius = ClientPreference.SetClientBorderRadius(wrapper.Notification);
            StateHasChanged();
            return Task.CompletedTask;
        });
    }

    private void Close() => MudDialog.Close();
}

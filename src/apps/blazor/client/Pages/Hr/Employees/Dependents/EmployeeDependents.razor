@page "/hr/employee-dependents"
@namespace FSH.Starter.Blazor.Client.Pages.Hr.Employees.Dependents

<PageHeader Title="@($"Employee Dependents{FilterSuffix}")" Header="Employee Dependents" SubHeader="Manage employee family members and dependents.">
    <Actions>
        <MudButton Variant="Variant.Outlined" 
                   Color="Color.Primary" 
                   StartIcon="@Icons.Material.Filled.ArrowBack"
                   Href="/hr/employees">
            Back to Employees
        </MudButton>
        <MudButton Variant="Variant.Outlined" 
                   Color="Color.Info" 
                   StartIcon="@Icons.Material.Filled.Help"
                   OnClick="@ShowDependentsHelp">
            Help
        </MudButton>
    </Actions>
</PageHeader>

@if (!string.IsNullOrEmpty(FilterEmployeeId))
{
    <MudAlert Severity="Severity.Info" Class="mb-4">
        Viewing dependents for Employee ID: <strong>@FilterEmployeeId</strong>
        <MudButton Size="Size.Small" Variant="Variant.Text" OnClick="@(() => ClearFilter())" Class="float-right">Clear Filter</MudButton>
    </MudAlert>
}

<EntityTable TEntity="EmployeeDependentResponse" TId="DefaultIdType" TRequest="EmployeeDependentViewModel" Context="@Context">
    <EditFormContent Context="context">
        @if (context.Id != DefaultIdType.Empty)
        {
            <MudItem xs="12" sm="6" md="4">
                <MudTextField Value="context.Id" Underline="false" ReadOnly Label="Dependent ID" />
            </MudItem>
        }

        <MudDivider DividerType="DividerType.FullWidth" Class="my-4" />

        <MudItem xs="12">
            <MudText Typo="Typo.subtitle2" GutterBottom="true">Dependent Information</MudText>
        </MudItem>

        <MudItem xs="12" sm="6" md="4">
            <MudTextField @bind-Value="context.FirstName"
                          For="@(() => context.FirstName)"
                          Label="First Name"
                          Variant="Variant.Filled"
                          Required="true" />
        </MudItem>

        <MudItem xs="12" sm="6" md="4">
            <MudTextField @bind-Value="context.LastName"
                          For="@(() => context.LastName)"
                          Label="Last Name"
                          Variant="Variant.Filled"
                          Required="true" />
        </MudItem>

        <MudItem xs="12" sm="6" md="4">
            <MudSelect T="string?"
                       @bind-Value="context.Relationship"
                       For="@(() => context.Relationship)"
                       Label="Relationship"
                       Variant="Variant.Filled"
                       Required="true">
                <MudSelectItem Value="@("Spouse")">Spouse</MudSelectItem>
                <MudSelectItem Value="@("Child")">Child</MudSelectItem>
                <MudSelectItem Value="@("Parent")">Parent</MudSelectItem>
                <MudSelectItem Value="@("Sibling")">Sibling</MudSelectItem>
                <MudSelectItem Value="@("Other")">Other</MudSelectItem>
            </MudSelect>
        </MudItem>

        <MudItem xs="12" sm="6" md="4">
            <MudDatePicker @bind-Date="context.DateOfBirth"
                           For="@(() => context.DateOfBirth)"
                           Label="Date of Birth"
                           DateFormat="MMMM dd, yyyy"
                           MaxDate="@DateTime.Today"
                           Variant="Variant.Filled"
                           Required="true"
                           HelperText="Must be a valid past date" />
        </MudItem>

        <MudItem xs="12">
            <MudTextField @bind-Value="context.Relationship"
                          For="@(() => context.Relationship)"
                          Label="Relationship Description"
                          Variant="Variant.Filled" />
        </MudItem>

        <MudItem xs="12" sm="6" md="4">
            <MudSwitch @bind-Value="context.IsClaimableDependent"
                       Class="mt-3"
                       For="@(() => context.IsClaimableDependent)"
                       Label="Claim as Tax Dependent"
                       Color="Color.Primary" />
        </MudItem>

    </EditFormContent>
</EntityTable>


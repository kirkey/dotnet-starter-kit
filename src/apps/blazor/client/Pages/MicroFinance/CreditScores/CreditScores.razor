@page "/microfinance/credit-scores"
@using FSH.Starter.Blazor.Client.Pages.MicroFinance.CreditScores.Dialogs
@using FSH.Starter.Blazor.Client.Components.EntityTable

<MudPaper Elevation="@_clientPreference.BorderRadius" Class="pa-4 mb-4" Style="@($"border-radius: {_clientPreference.BorderRadius}px;")">
    <MudStack Row="true" Class="mb-2" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
        <MudText Typo="Typo.h5">
            <MudIcon Icon="@Icons.Material.Filled.Score" Class="mr-2" />
            Credit Scores
        </MudText>
        <MudStack Row="true" Spacing="2">
            <MudButtonGroup Variant="Variant.Outlined" Size="Size.Small">
                <MudButton StartIcon="@Icons.Material.Filled.FilterAlt" Color="Color.Default">Grade</MudButton>
                <MudMenu Icon="@Icons.Material.Filled.ArrowDropDown" Color="Color.Default">
                    <MudMenuItem OnClick="@(() => _selectedGrade = null)">All</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedGrade = "A")">A - Excellent</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedGrade = "B")">B - Good</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedGrade = "C")">C - Fair</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedGrade = "D")">D - Poor</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedGrade = "E")">E - Very Poor</MudMenuItem>
                </MudMenu>
            </MudButtonGroup>
            <MudButtonGroup Variant="Variant.Outlined" Size="Size.Small">
                <MudButton StartIcon="@Icons.Material.Filled.Source" Color="Color.Default">Source</MudButton>
                <MudMenu Icon="@Icons.Material.Filled.ArrowDropDown" Color="Color.Default">
                    <MudMenuItem OnClick="@(() => _selectedSource = null)">All</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedSource = "Internal")">Internal</MudMenuItem>
                    <MudMenuItem OnClick="@(() => _selectedSource = "CreditBureau")">Credit Bureau</MudMenuItem>
                </MudMenu>
            </MudButtonGroup>
            <MudIconButton Icon="@Icons.Material.Filled.Help" Color="Color.Primary" OnClick="ShowHelp" />
        </MudStack>
    </MudStack>
</MudPaper>

<EntityTable @ref="_table"
             TEntity="CreditScoreResponse"
             TId="DefaultIdType"
             TRequest="CreditScoreViewModel"
             Context="@_context"
             Dense="true"
             Striped="true"
             Hover="true">
    <ActionsContent>
        <MudMenu Icon="@Icons.Material.Filled.MoreVert" Size="Size.Small" Dense="true">
            <MudMenuItem Icon="@Icons.Material.Filled.Info"
                        OnClick="@(() => ShowDetails(context))">
                View Details
            </MudMenuItem>
            <MudMenuItem Icon="@Icons.Material.Filled.Refresh"
                        OnClick="@(() => RefreshScore(context))"
                        Disabled="@(!_canCreate)">
                Refresh Score
            </MudMenuItem>
            <MudMenuItem Icon="@Icons.Material.Filled.Analytics"
                        OnClick="@(() => ShowScoreFactors(context))">
                View Factors
            </MudMenuItem>
        </MudMenu>
    </ActionsContent>
    <ExtraActions>
        <MudButton Variant="Variant.Filled"
                   Color="Color.Primary"
                   StartIcon="@Icons.Material.Filled.Add"
                   OnClick="@(() => _table!.InvokeModal())"
                   Disabled="@(!_canCreate)">
            Add Score
        </MudButton>
    </ExtraActions>
</EntityTable>


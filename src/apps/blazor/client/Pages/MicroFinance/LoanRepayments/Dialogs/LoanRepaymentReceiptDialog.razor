<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Receipt" Class="mr-2" Color="Color.Primary" />
            Payment Receipt
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudPaper Elevation="0" Class="pa-4" Style="border: 1px solid #e0e0e0;">
            <MudStack Spacing="4">
                <MudText Typo="Typo.h5" Align="Align.Center">PAYMENT RECEIPT</MudText>
                <MudDivider />

                <MudGrid>
                    <MudItem xs="6">
                        <MudText Typo="Typo.caption" Color="Color.Secondary">Receipt Number</MudText>
                        <MudText Typo="Typo.body1"><strong>@Repayment.ReceiptNumber</strong></MudText>
                    </MudItem>
                    <MudItem xs="6" Style="text-align: right;">
                        <MudText Typo="Typo.caption" Color="Color.Secondary">Date</MudText>
                        <MudText Typo="Typo.body1"><strong>@Repayment.PaymentDate.ToString("dd MMM yyyy")</strong></MudText>
                    </MudItem>
                </MudGrid>

                <MudDivider />

                <MudGrid>
                    <MudItem xs="6">
                        <MudText Typo="Typo.caption" Color="Color.Secondary">Loan Number</MudText>
                        <MudText Typo="Typo.body1">@Repayment.LoanNumber</MudText>
                    </MudItem>
                    <MudItem xs="6">
                        <MudText Typo="Typo.caption" Color="Color.Secondary">Payment Method</MudText>
                        <MudText Typo="Typo.body1">@Repayment.PaymentMethod</MudText>
                    </MudItem>
                </MudGrid>

                <MudDivider />

                <MudSimpleTable Dense="true" Hover="true">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th style="text-align: right;">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Principal Repayment</td>
                            <td style="text-align: right;">@Repayment.PrincipalAmount.ToString("N2")</td>
                        </tr>
                        <tr>
                            <td>Interest Payment</td>
                            <td style="text-align: right;">@Repayment.InterestAmount.ToString("N2")</td>
                        </tr>
                        @if (Repayment.PenaltyAmount > 0)
                        {
                            <tr>
                                <td>Penalty Amount</td>
                                <td style="text-align: right;">@Repayment.PenaltyAmount.ToString("N2")</td>
                            </tr>
                        }
                        <tr style="font-weight: bold;">
                            <td>Total Amount Paid</td>
                            <td style="text-align: right;">@Repayment.Amount.ToString("N2")</td>
                        </tr>
                    </tbody>
                </MudSimpleTable>

                @if (!string.IsNullOrEmpty(Repayment.TransactionReference))
                {
                    <MudText Typo="Typo.caption" Color="Color.Secondary">
                        Transaction Reference: @Repayment.TransactionReference
                    </MudText>
                }

                <MudDivider />

                <MudText Typo="Typo.caption" Align="Align.Center" Color="Color.Secondary">
                    Thank you for your payment!
                </MudText>
            </MudStack>
        </MudPaper>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Cancel" Variant="Variant.Text">Close</MudButton>
        <MudButton Color="Color.Primary" 
                   Variant="Variant.Filled" 
                   StartIcon="@Icons.Material.Filled.Print"
                   OnClick="@PrintReceipt">
            Print
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public LoanRepaymentResponse Repayment { get; set; } = null!;

    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private void Cancel() => MudDialog.Cancel();

    private void PrintReceipt()
    {
        // Note: Implement print functionality
        Snackbar.Add("Print functionality would trigger browser print dialog.", Severity.Info);
    }
}

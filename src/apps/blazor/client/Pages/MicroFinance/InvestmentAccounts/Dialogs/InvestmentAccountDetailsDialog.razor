<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Visibility" Class="mr-2" />
            Investment Account Details - @Account.AccountNumber
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudGrid>
            <MudItem xs="12" md="6">
                <MudField Label="Account Number" Variant="Variant.Outlined">@Account.AccountNumber</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Member" Variant="Variant.Outlined">@Account.MemberName</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Risk Profile" Variant="Variant.Outlined">
                    <MudChip T="string" Color="@GetRiskColor(Account.RiskProfile)" Size="Size.Small">@Account.RiskProfile</MudChip>
                </MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Status" Variant="Variant.Outlined">
                    <MudChip T="string" Color="@GetStatusColor(Account.Status)" Size="Size.Small">@Account.Status</MudChip>
                </MudField>
            </MudItem>
            @if (!string.IsNullOrEmpty(Account.AssignedAdvisorName))
            {
                <MudItem xs="12" md="6">
                    <MudField Label="Assigned Advisor" Variant="Variant.Outlined">@Account.AssignedAdvisorName</MudField>
                </MudItem>
            }
            @if (!string.IsNullOrEmpty(Account.InvestmentGoal))
            {
                <MudItem xs="12" md="6">
                    <MudField Label="Investment Goal" Variant="Variant.Outlined">@Account.InvestmentGoal</MudField>
                </MudItem>
            }
            <MudItem xs="12">
                <MudDivider Class="my-2" />
                <MudText Typo="Typo.subtitle1" Class="mb-2">Portfolio Summary</MudText>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudField Label="Total Invested" Variant="Variant.Outlined">@Account.TotalInvested.ToString("C")</MudField>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudField Label="Current Value" Variant="Variant.Outlined">@Account.CurrentValue.ToString("C")</MudField>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudField Label="Unrealized Gain/Loss" Variant="Variant.Outlined">
                    <MudText Color="@(Account.UnrealizedGainLoss >= 0 ? Color.Success : Color.Error)">
                        @Account.UnrealizedGainLoss.ToString("C")
                    </MudText>
                </MudField>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudField Label="Realized Gain/Loss" Variant="Variant.Outlined">
                    <MudText Color="@(Account.RealizedGainLoss >= 0 ? Color.Success : Color.Error)">
                        @Account.RealizedGainLoss.ToString("C")
                    </MudText>
                </MudField>
            </MudItem>
        </MudGrid>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Cancel" Variant="Variant.Filled" Color="Color.Primary">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public InvestmentAccountResponse Account { get; set; } = null!;

    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private void Cancel() => MudDialog.Cancel();

    private Color GetRiskColor(string? riskProfile) => riskProfile?.ToLowerInvariant() switch
    {
        "conservative" => Color.Success,
        "moderate" => Color.Info,
        "balanced" => Color.Warning,
        "aggressive" => Color.Error,
        _ => Color.Default
    };

    private Color GetStatusColor(string? status) => status?.ToLowerInvariant() switch
    {
        "active" => Color.Success,
        "inactive" => Color.Default,
        "suspended" => Color.Warning,
        "closed" => Color.Error,
        _ => Color.Default
    };
}

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Visibility" Class="mr-2" />
            Investment Product Details - @Product.Name
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudGrid>
            <MudItem xs="12" md="6">
                <MudField Label="Code" Variant="Variant.Outlined">@Product.Code</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Name" Variant="Variant.Outlined">@Product.Name</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Product Type" Variant="Variant.Outlined">@Product.ProductType</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Risk Level" Variant="Variant.Outlined">
                    <MudChip T="string" Color="@GetRiskColor(Product.RiskLevel)" Size="Size.Small">@Product.RiskLevel</MudChip>
                </MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Minimum Investment" Variant="Variant.Outlined">@Product.MinimumInvestment.ToString("C")</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Management Fee %" Variant="Variant.Outlined">@Product.ManagementFeePercent.ToString("F2")%</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Expected Return Range" Variant="Variant.Outlined">@Product.ExpectedReturnMin.ToString("F2")% - @Product.ExpectedReturnMax.ToString("F2")%</MudField>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudField Label="Lock-In Period" Variant="Variant.Outlined">@Product.LockInPeriodDays days</MudField>
            </MudItem>
            @if (Product.CurrentNav.HasValue)
            {
                <MudItem xs="12" md="6">
                    <MudField Label="Current NAV" Variant="Variant.Outlined">@Product.CurrentNav.Value.ToString("C")</MudField>
                </MudItem>
            }
            @if (Product.NavDate.HasValue)
            {
                <MudItem xs="12" md="6">
                    <MudField Label="NAV Date" Variant="Variant.Outlined">@Product.NavDate.Value.ToString("d")</MudField>
                </MudItem>
            }
            @if (!string.IsNullOrEmpty(Product.Description))
            {
                <MudItem xs="12">
                    <MudField Label="Description" Variant="Variant.Outlined">@Product.Description</MudField>
                </MudItem>
            }
        </MudGrid>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Cancel" Variant="Variant.Filled" Color="Color.Primary">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public InvestmentProductResponse Product { get; set; } = null!;

    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private void Cancel() => MudDialog.Cancel();

    private Color GetRiskColor(string? riskLevel) => riskLevel?.ToLowerInvariant() switch
    {
        "low" => Color.Success,
        "medium" => Color.Warning,
        "high" => Color.Error,
        "very high" => Color.Dark,
        _ => Color.Default
    };
}

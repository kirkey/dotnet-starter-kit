@namespace FSH.Starter.Blazor.Client.Pages.MicroFinance.Members

<MudDialog>
    <DialogContent>
        <MudStack Spacing="3">
            <MudText Typo="Typo.h6">Members Management Help</MudText>

            <MudExpansionPanels Elevation="@_preference.Elevation">
                <MudExpansionPanel Text="What is Member Management?">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Understanding Member Records</MudText>
                        <MudText Typo="Typo.body2">
                            Member management maintains the master record of all clients who access microfinance services. 
                            Members are individuals who can open savings accounts, apply for loans, and participate in group activities.
                        </MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Why Member Records Matter:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • <strong>KYC Compliance:</strong> Know Your Customer requirements for financial services<br/>
                                • <strong>Credit Assessment:</strong> Income and occupation data for loan evaluation<br/>
                                • <strong>Account Management:</strong> Link savings and loan accounts to members<br/>
                                • <strong>Communication:</strong> Contact information for notices and collections<br/>
                                • <strong>Reporting:</strong> Demographics, geographic distribution, portfolio analysis<br/>
                                • <strong>Risk Management:</strong> Identity verification and fraud prevention
                            </MudText>
                        </div>

                        <MudAlert Severity="Severity.Info" Dense="true">
                            <strong>Best Practice:</strong> Collect complete and accurate member information during onboarding to ensure smooth operations.
                        </MudAlert>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Member Lifecycle">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">From Enrollment to Graduation</MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>1. Prospecting:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Identify potential members in target communities<br/>
                                • Conduct awareness sessions about services<br/>
                                • Explain membership requirements and benefits
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>2. Enrollment:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Collect application form and required documents<br/>
                                • Verify identity using government-issued ID<br/>
                                • Conduct character reference checks<br/>
                                • Assign member number and create record
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>3. Onboarding:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Open initial savings account<br/>
                                • Explain products and services<br/>
                                • Set up group membership if applicable<br/>
                                • Collect membership fees and initial deposit
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>4. Active Membership:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Access to savings, loans, and other services<br/>
                                • Regular attendance at group meetings<br/>
                                • Timely repayment of loans<br/>
                                • Building credit history
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>5. Graduation/Exit:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Member transitions to formal banking<br/>
                                • Voluntary withdrawal from program<br/>
                                • Account closure and final settlement
                            </MudText>
                        </div>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Required Documents">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">KYC Documentation Requirements</MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Identity Verification:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Government-issued photo ID (passport, national ID, driver's license)<br/>
                                • Recent passport-size photograph<br/>
                                • Birth certificate (for age verification)
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Address Verification:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Utility bill (electricity, water, phone)<br/>
                                • Rental agreement or property documents<br/>
                                • Local authority certificate
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Income Verification:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Salary slips or employment letter<br/>
                                • Business registration (for self-employed)<br/>
                                • Bank statements (last 3-6 months)
                            </MudText>
                        </div>

                        <MudAlert Severity="Severity.Warning" Dense="true">
                            <strong>Note:</strong> Document requirements may vary based on regulatory requirements and loan amount.
                        </MudAlert>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Member Status">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Understanding Member Status</MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Active:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Member is in good standing<br/>
                                • Can access all services<br/>
                                • Eligible for new loans (subject to limits)<br/>
                                • Can make deposits and withdrawals
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Inactive:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Temporarily suspended or dormant<br/>
                                • Cannot apply for new loans<br/>
                                • May have limited withdrawal access<br/>
                                • Requires reactivation to resume services
                            </MudText>
                        </div>

                        <MudAlert Severity="Severity.Info" Dense="true">
                            <strong>Tip:</strong> Regularly review inactive members and follow up to understand their situation.
                        </MudAlert>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Best Practices">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Member Management Best Practices</MudText>
                        
                        <MudList T="string" Dense="true">
                            <MudListItem Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                                <MudText Typo="Typo.caption">Verify all documents before member approval</MudText>
                            </MudListItem>
                            <MudListItem Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                                <MudText Typo="Typo.caption">Keep contact information current</MudText>
                            </MudListItem>
                            <MudListItem Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                                <MudText Typo="Typo.caption">Update income information annually</MudText>
                            </MudListItem>
                            <MudListItem Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                                <MudText Typo="Typo.caption">Maintain confidentiality of member data</MudText>
                            </MudListItem>
                            <MudListItem Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                                <MudText Typo="Typo.caption">Document all member interactions</MudText>
                            </MudListItem>
                            <MudListItem Icon="@Icons.Material.Filled.CheckCircle" IconColor="Color.Success">
                                <MudText Typo="Typo.caption">Use member groups for peer support and accountability</MudText>
                            </MudListItem>
                        </MudList>
                    </MudStack>
                </MudExpansionPanel>
            </MudExpansionPanels>
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Primary" OnClick="@Close" Variant="Variant.Filled">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private ClientPreference _preference = new();

    protected override async Task OnInitializedAsync()
    {
        if (await ClientPreferences.GetPreference() is ClientPreference preference)
        {
            _preference = preference;
        }
    }

    private void Close() => MudDialog.Close();
}

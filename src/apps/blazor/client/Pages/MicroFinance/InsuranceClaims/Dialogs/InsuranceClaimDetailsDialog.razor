@using FSH.Starter.WebApi.MicroFinance.Application.InsuranceClaims.Get.v1

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Policy" Class="mr-2" />
            Claim Details - @Entity.ClaimNumber
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudGrid>
            <MudItem xs="12">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Claim Information</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Claim Number</MudText>
                <MudText>@Entity.ClaimNumber</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Claim Type</MudText>
                <MudText>@Entity.ClaimType</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Status</MudText>
                <MudChip Color="@GetStatusColor(Entity.Status)" Size="Size.Small">@Entity.Status</MudChip>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Amounts</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Claim Amount</MudText>
                <MudText><strong>@Entity.ClaimAmount.ToString("N0")</strong></MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Approved Amount</MudText>
                <MudText Color="@(Entity.ApprovedAmount.HasValue ? Color.Success : Color.Default)">
                    @(Entity.ApprovedAmount?.ToString("N0") ?? "-")
                </MudText>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Dates</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Incident Date</MudText>
                <MudText>@Entity.IncidentDate.ToShortDateString()</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Filed Date</MudText>
                <MudText>@Entity.FiledDate.ToShortDateString()</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Payment Date</MudText>
                <MudText>@(Entity.PaymentDate?.ToShortDateString() ?? "-")</MudText>
            </MudItem>

            @if (!string.IsNullOrEmpty(Entity.Description))
            {
                <MudItem xs="12" Class="mt-4">
                    <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Description</strong></MudText>
                    <MudDivider />
                </MudItem>
                <MudItem xs="12">
                    <MudText>@Entity.Description</MudText>
                </MudItem>
            }

            @if (!string.IsNullOrEmpty(Entity.RejectionReason))
            {
                <MudItem xs="12">
                    <MudAlert Severity="Severity.Error">
                        <strong>Rejection Reason:</strong> @Entity.RejectionReason
                    </MudAlert>
                </MudItem>
            }
        </MudGrid>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Close" Variant="Variant.Text">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public InsuranceClaimResponse Entity { get; set; } = null!;

    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private void Close() => MudDialog.Close();

    private Color GetStatusColor(string status) => status switch
    {
        "Submitted" => Color.Info,
        "UnderReview" => Color.Warning,
        "Approved" => Color.Success,
        "Rejected" => Color.Error,
        "Settled" => Color.Primary,
        _ => Color.Default
    };
}

@namespace FSH.Starter.Blazor.Client.Pages.MicroFinance.MemberGroups

<MudDialog>
    <DialogContent>
        <MudStack Spacing="3">
            <MudText Typo="Typo.h6">Member Groups Help</MudText>

            <MudExpansionPanels Elevation="@_preference.Elevation">
                <MudExpansionPanel Text="What are Member Groups?" Icon="@Icons.Material.Filled.MenuBook">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Understanding Group Lending</MudText>
                        <MudText Typo="Typo.body2">
                            Member groups are the foundation of group-based microfinance methodology. 
                            Members form solidarity groups for mutual support, savings mobilization, and collective loan guarantee.
                        </MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Types of Groups:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • <strong>Solidarity Groups:</strong> 5-10 members who cross-guarantee each other's loans<br/>
                                • <strong>Village Savings Groups:</strong> 15-30 members with savings pool<br/>
                                • <strong>Self-Help Groups:</strong> Community-driven savings and credit groups<br/>
                                • <strong>Joint Liability Groups:</strong> Members share responsibility for repayment
                            </MudText>
                        </div>

                        <MudAlert Severity="Severity.Info" Dense="true">
                            <strong>Benefit:</strong> Group methodology reduces default risk through peer pressure and mutual support.
                        </MudAlert>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Group Lifecycle" Icon="@Icons.Material.Filled.Timeline">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">From Formation to Graduation</MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>1. Formation (Week 1-2):</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Identify potential members in target area<br/>
                                • Conduct awareness meeting about MFI services<br/>
                                • Self-selection of members (know each other)<br/>
                                • Elect group leader and secretary
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>2. Training (Week 3-4):</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Compulsory group training (CGT)<br/>
                                • Explain rules, policies, and obligations<br/>
                                • Practice meeting procedures<br/>
                                • Start compulsory savings
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>3. Recognition Test:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Verify group cohesion and knowledge<br/>
                                • All members must pass test<br/>
                                • Group is officially recognized
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>4. Active Operations:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Regular meetings (weekly/biweekly)<br/>
                                • Savings collection and loan disbursements<br/>
                                • Repayment collection and monitoring<br/>
                                • Social fund contributions
                            </MudText>
                        </div>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Group Meetings" Icon="@Icons.Material.Filled.Info">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Meeting Structure</MudText>
                        <MudText Typo="Typo.body2">
                            Regular group meetings are essential for collections, disbursements, and member engagement.
                        </MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Typical Meeting Agenda:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                1. Opening and attendance<br/>
                                2. Collect savings contributions<br/>
                                3. Collect loan repayments<br/>
                                4. Process loan applications<br/>
                                5. Disburse approved loans<br/>
                                6. Discuss group matters<br/>
                                7. Financial literacy training<br/>
                                8. Closing and next meeting date
                            </MudText>
                        </div>

                        <MudAlert Severity="Severity.Warning" Dense="true">
                            <strong>Important:</strong> Meetings should be held at the same time and place for consistency.
                        </MudAlert>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Group Leader Roles" Icon="@Icons.Material.Filled.Info">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Leadership Responsibilities</MudText>
                        
                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Group Leader:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Conduct and facilitate meetings<br/>
                                • Ensure attendance and discipline<br/>
                                • Represent group to MFI<br/>
                                • Follow up on delinquent members<br/>
                                • Resolve internal conflicts
                            </MudText>
                        </div>

                        <div>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                <strong>Group Secretary:</strong>
                            </MudText>
                            <MudText Typo="Typo.caption">
                                • Maintain attendance records<br/>
                                • Keep passbooks and documents<br/>
                                • Assist with cash counting<br/>
                                • Record minutes of meetings
                            </MudText>
                        </div>
                    </MudStack>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Creating a New Group" Icon="@Icons.Material.Filled.AddCircle">
                    <MudStack Spacing="2">
                        <MudText Typo="Typo.subtitle2">Step-by-Step Guide</MudText>
                        
                        <ol>
                            <li><MudText Typo="Typo.caption">Click the <strong>+</strong> button to open the add group form</MudText></li>
                            <li><MudText Typo="Typo.caption">Enter a unique <strong>Group Code</strong> (e.g., GRP-SAMPALOC-01)</MudText></li>
                            <li><MudText Typo="Typo.caption">Provide the <strong>Group Name</strong> and <strong>Description</strong></MudText></li>
                            <li><MudText Typo="Typo.caption">Set the <strong>Formation Date</strong></MudText></li>
                            <li><MudText Typo="Typo.caption">Configure <strong>Meeting Schedule</strong> (frequency, day, time, location)</MudText></li>
                            <li><MudText Typo="Typo.caption">Click <strong>Save</strong> to create the group</MudText></li>
                        </ol>

                        <MudAlert Severity="Severity.Info" Dense="true">
                            <strong>Next Steps:</strong> After creating the group, add members using the "Manage Members" action.
                        </MudAlert>
                    </MudStack>
                </MudExpansionPanel>
            </MudExpansionPanels>
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Close" Color="Color.Primary">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] 
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private ClientPreference _preference = new();

    protected override async Task OnInitializedAsync()
    {
        if (await ClientPreferences.GetPreference() is ClientPreference preference)
        {
            _preference = preference;
        }
    }

    private void Close() => MudDialog.Close();
}

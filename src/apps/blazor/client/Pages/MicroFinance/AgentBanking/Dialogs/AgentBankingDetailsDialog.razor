<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Store" Class="mr-2" />
            Agent Details - @Entity.AgentCode
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudGrid>
            <MudItem xs="12">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Agent Information</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Agent Code</MudText>
                <MudText>@Entity.AgentCode</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Business Name</MudText>
                <MudText>@Entity.BusinessName</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Contact Person</MudText>
                <MudText>@Entity.ContactName</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Status</MudText>
                <MudChip T="string" Color="@GetStatusColor(Entity.Status)" Size="Size.Small">@Entity.Status</MudChip>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Tier</MudText>
                <MudChip T="string" Color="@GetTierColor(Entity.Tier)" Size="Size.Small">@Entity.Tier</MudChip>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">KYC Verified</MudText>
                @if (Entity.IsKycVerified)
                {
                    <MudIcon Icon="@Icons.Material.Filled.CheckCircle" Color="Color.Success" />
                }
                else
                {
                    <MudIcon Icon="@Icons.Material.Filled.Cancel" Color="Color.Error" />
                }
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Contact Details</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Phone Number</MudText>
                <MudText>@Entity.PhoneNumber</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Email</MudText>
                <MudText>@(Entity.Email ?? "-")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Operating Hours</MudText>
                <MudText>@(Entity.OperatingHours ?? "-")</MudText>
            </MudItem>
            <MudItem xs="12" sm="8">
                <MudText Typo="Typo.caption">Address</MudText>
                <MudText>@Entity.Address</MudText>
            </MudItem>
            <MudItem xs="12" sm="4">
                <MudText Typo="Typo.caption">GPS Coordinates</MudText>
                <MudText>@(Entity.GpsCoordinates ?? "-")</MudText>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Float & Commission</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Current Float Balance</MudText>
                <MudText Color="@(Entity.FloatBalance >= Entity.MinFloatBalance ? Color.Success : Color.Error)">
                    <strong>@Entity.FloatBalance.ToString("N2")</strong>
                </MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Min Float</MudText>
                <MudText>@Entity.MinFloatBalance.ToString("N2")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Max Float</MudText>
                <MudText>@Entity.MaxFloatBalance.ToString("N2")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Commission Rate</MudText>
                <MudText>@Entity.CommissionRate.ToString("P2")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Total Commission Earned</MudText>
                <MudText Color="Color.Success">@Entity.TotalCommissionEarned.ToString("N2")</MudText>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Transaction Limits & Volume</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Daily Limit</MudText>
                <MudText>@Entity.DailyTransactionLimit.ToString("N0")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Monthly Limit</MudText>
                <MudText>@Entity.MonthlyTransactionLimit.ToString("N0")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Daily Volume</MudText>
                <MudText>@Entity.DailyVolumeProcessed.ToString("N0")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Monthly Volume</MudText>
                <MudText>@Entity.MonthlyVolumeProcessed.ToString("N0")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Transactions Today</MudText>
                <MudText>@Entity.TotalTransactionsToday</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Transactions This Month</MudText>
                <MudText>@Entity.TotalTransactionsMonth</MudText>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Contract & Compliance</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Contract Start</MudText>
                <MudText>@Entity.ContractStartDate.ToShortDateString()</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Contract End</MudText>
                <MudText>@(Entity.ContractEndDate?.ToShortDateString() ?? "Open-ended")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Last Training</MudText>
                <MudText>@(Entity.LastTrainingDate?.ToShortDateString() ?? "-")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="3">
                <MudText Typo="Typo.caption">Last Audit</MudText>
                <MudText>@(Entity.LastAuditDate?.ToShortDateString() ?? "-")</MudText>
            </MudItem>
        </MudGrid>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Close" Variant="Variant.Text">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public AgentBankingResponse Entity { get; set; } = null!;

    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private void Close() => MudDialog.Close();

    private Color GetStatusColor(string status) => status switch
    {
        "Active" => Color.Success,
        "Pending" => Color.Warning,
        "Suspended" => Color.Error,
        _ => Color.Default
    };

    private Color GetTierColor(string tier) => tier switch
    {
        "Premium" => Color.Primary,
        "Standard" => Color.Info,
        "Basic" => Color.Default,
        _ => Color.Default
    };
}

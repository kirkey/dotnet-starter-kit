<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.PhoneAndroid" Class="mr-2" />
            Wallet Details - @Entity.PhoneNumber
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudGrid>
            <MudItem xs="12">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Wallet Information</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Phone Number</MudText>
                <MudText>@Entity.PhoneNumber</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Provider</MudText>
                <MudText>@Entity.Provider</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Status</MudText>
                <MudChip T="string" Color="@GetStatusColor(Entity.Status)" Size="Size.Small">@Entity.Status</MudChip>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Tier</MudText>
                <MudChip T="string" Color="@GetTierColor(Entity.Tier)" Size="Size.Small">@Entity.Tier</MudChip>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">External Wallet ID</MudText>
                <MudText>@(Entity.ExternalWalletId ?? "-")</MudText>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Balance & Limits</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Current Balance</MudText>
                <MudText Color="Color.Success"><strong>@Entity.Balance.ToString("N2")</strong></MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Daily Limit</MudText>
                <MudText>@Entity.DailyLimit.ToString("N0")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Monthly Limit</MudText>
                <MudText>@Entity.MonthlyLimit.ToString("N0")</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Daily Used</MudText>
                <MudText Color="@(Entity.DailyUsed >= Entity.DailyLimit * 0.8m ? Color.Warning : Color.Default)">
                    @Entity.DailyUsed.ToString("N0") / @Entity.DailyLimit.ToString("N0")
                </MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Monthly Used</MudText>
                <MudText Color="@(Entity.MonthlyUsed >= Entity.MonthlyLimit * 0.8m ? Color.Warning : Color.Default)">
                    @Entity.MonthlyUsed.ToString("N0") / @Entity.MonthlyLimit.ToString("N0")
                </MudText>
            </MudItem>

            <MudItem xs="12" Class="mt-4">
                <MudText Typo="Typo.subtitle1" Class="mb-2"><strong>Linked Accounts</strong></MudText>
                <MudDivider />
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Linked to Bank Account</MudText>
                @if (Entity.IsLinkedToBankAccount)
                {
                    <MudIcon Icon="@Icons.Material.Filled.CheckCircle" Color="Color.Success" />
                }
                else
                {
                    <MudIcon Icon="@Icons.Material.Filled.Cancel" Color="Color.Default" />
                }
            </MudItem>
            <MudItem xs="12" sm="6" md="4">
                <MudText Typo="Typo.caption">Last Activity</MudText>
                <MudText>@(Entity.LastActivityDate?.ToShortDateString() ?? "-")</MudText>
            </MudItem>
        </MudGrid>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Close" Variant="Variant.Text">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public MobileWalletResponse Entity { get; set; } = null!;

    [CascadingParameter]
    private IMudDialogInstance MudDialog { get; set; } = null!;

    private void Close() => MudDialog.Close();

    private Color GetStatusColor(string status) => status switch
    {
        "Active" => Color.Success,
        "Pending" => Color.Warning,
        "Suspended" => Color.Error,
        _ => Color.Default
    };

    private Color GetTierColor(string tier) => tier switch
    {
        "Premium" => Color.Primary,
        "Standard" => Color.Info,
        "Basic" => Color.Default,
        _ => Color.Default
    };
}

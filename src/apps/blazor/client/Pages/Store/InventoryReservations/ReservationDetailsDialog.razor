<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Info" Class="mr-1" />
            Reservation Details
        </MudText>
    </TitleContent>
    <DialogContent>
        @if (_loading)
        {
            <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
        }
        else if (_reservation != null)
        {
            <MudGrid>
                <MudItem xs="12">
                    <MudPaper Elevation="0" Class="pa-4 mb-4">
                        <MudText Typo="Typo.h6" Class="mb-2">General Information</MudText>
                        <MudDivider Class="mb-3" />
                        
                        <MudGrid>
                            <MudItem xs="12" md="6">
                                <MudTextField Label="Reservation Number" Value="@_reservation.ReservationNumber" ReadOnly="true" Variant="Variant.Filled" />
                            </MudItem>
                            <MudItem xs="12" md="6">
                                <MudChip T="string" Color="@GetStatusColor(_reservation.Status ?? string.Empty)" Size="Size.Medium">@_reservation.Status</MudChip>
                            </MudItem>
                            <MudItem xs="12" md="6">
                                <MudTextField Label="Item" Value="@_reservation.ItemName" ReadOnly="true" Variant="Variant.Filled" />
                            </MudItem>
                            <MudItem xs="12" md="6">
                                <MudTextField Label="Warehouse" Value="@_reservation.WarehouseName" ReadOnly="true" Variant="Variant.Filled" />
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudItem>

                <MudItem xs="12">
                    <MudPaper Elevation="0" Class="pa-4 mb-4">
                        <MudText Typo="Typo.h6" Class="mb-2">Quantity & Type</MudText>
                        <MudDivider Class="mb-3" />
                        
                        <MudGrid>
                            <MudItem xs="12" md="4">
                                <MudNumericField Label="Quantity Reserved" Value="@_reservation.ReservedQuantity" ReadOnly="true" Variant="Variant.Filled" />
                            </MudItem>
                            <MudItem xs="12" md="4">
                                <MudTextField Label="Reservation Type" Value="@_reservation.ReferenceType" ReadOnly="true" Variant="Variant.Filled" />
                            </MudItem>
                            @if (_reservation.ReferenceId.HasValue)
                            {
                                <MudItem xs="12" md="4">
                                    <MudTextField Label="Reference ID" Value="@_reservation.ReferenceId.ToString()" ReadOnly="true" Variant="Variant.Filled" />
                                </MudItem>
                            }
                        </MudGrid>
                    </MudPaper>
                </MudItem>

                <MudItem xs="12">
                    <MudPaper Elevation="0" Class="pa-4 mb-4">
                        <MudText Typo="Typo.h6" Class="mb-2">Dates & Timeline</MudText>
                        <MudDivider Class="mb-3" />
                        
                        <MudGrid>
                            <MudItem xs="12" md="6">
                                <MudTextField Label="Reservation Date" Value="@_reservation.ReservationDate.ToString("MMMM dd, yyyy")" ReadOnly="true" Variant="Variant.Filled" />
                            </MudItem>
                            @if (_reservation.ExpirationDate.HasValue)
                            {
                                <MudItem xs="12" md="6">
                                    <MudTextField Label="Expiration Date" Value="@(_reservation.ExpirationDate?.ToString("MMMM dd, yyyy"))" ReadOnly="true" Variant="Variant.Filled">
                                        @if (IsExpired(_reservation.ExpirationDate))
                                        {
                                            <MudChip T="string" Color="Color.Error" Size="Size.Small">Expired</MudChip>
                                        }
                                    </MudTextField>
                                </MudItem>
                            }
                        </MudGrid>
                    </MudPaper>
                </MudItem>

                @if (!string.IsNullOrEmpty(_reservation.Name) || !string.IsNullOrEmpty(_reservation.Description) || !string.IsNullOrEmpty(_reservation.Notes))
                {
                    <MudItem xs="12">
                        <MudPaper Elevation="0" Class="pa-4">
                            <MudText Typo="Typo.h6" Class="mb-2">Additional Information</MudText>
                            <MudDivider Class="mb-3" />
                            
                            <MudGrid>
                                @if (!string.IsNullOrEmpty(_reservation.Name))
                                {
                                    <MudItem xs="12">
                                        <MudTextField Label="Name" Value="@_reservation.Name" ReadOnly="true" Variant="Variant.Filled" />
                                    </MudItem>
                                }
                                @if (!string.IsNullOrEmpty(_reservation.Description))
                                {
                                    <MudItem xs="12">
                                        <MudTextField Label="Description" Value="@_reservation.Description" ReadOnly="true" Variant="Variant.Filled" Lines="2" />
                                    </MudItem>
                                }
                                @if (!string.IsNullOrEmpty(_reservation.Notes))
                                {
                                    <MudItem xs="12">
                                        <MudTextField Label="Notes" Value="@_reservation.Notes" ReadOnly="true" Variant="Variant.Filled" Lines="3" />
                                    </MudItem>
                                }
                            </MudGrid>
                        </MudPaper>
                    </MudItem>
                }
            </MudGrid>
        }
        else if (!string.IsNullOrEmpty(_errorMessage))
        {
            <MudAlert Severity="Severity.Error">@_errorMessage</MudAlert>
        }
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@(() => Cancel())" Variant="Variant.Filled">Close</MudButton>
    </DialogActions>
</MudDialog>


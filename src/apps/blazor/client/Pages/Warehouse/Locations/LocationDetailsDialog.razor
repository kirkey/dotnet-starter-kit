<MudDialog>
    <DialogContent>
        @if (_isLoading)
        {
            <MudProgressLinear Color="Color.Primary" Indeterminate="true" />
            <MudText Align="Align.Center" Class="my-4">Loading location details...</MudText>
        }
        else if (_location is not null)
        {
            <MudGrid>
                @* General Information *@
                <MudItem xs="12">
                    <MudText Typo="Typo.h6" Color="Color.Primary">General Information</MudText>
                    <MudDivider Class="mb-4" />
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudField Label="Location Code" Variant="Variant.Outlined">
                        @_location.Code
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudField Label="Location Name" Variant="Variant.Outlined">
                        @_location.Name
                    </MudField>
                </MudItem>

                <MudItem xs="12">
                    <MudField Label="Description" Variant="Variant.Outlined">
                        @(_location.Description ?? "N/A")
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudField Label="Warehouse" Variant="Variant.Outlined">
                        @_location.WarehouseName
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudField Label="Location Type" Variant="Variant.Outlined">
                        @_location.LocationType
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudStack Row="true" Spacing="2">
                        <MudChip Color="@GetStatusColor(_location.IsActive)" Size="Size.Small" Variant="Variant.Filled">
                            @(_location.IsActive ? "Active" : "Inactive")
                        </MudChip>
                        @if (_location.RequiresTemperatureControl)
                        {
                            <MudChip Color="Color.Info" Size="Size.Small" Icon="@Icons.Material.Filled.AcUnit">
                                Temperature Controlled
                            </MudChip>
                        }
                    </MudStack>
                </MudItem>

                @* Location Details *@
                <MudItem xs="12" Class="mt-4">
                    <MudText Typo="Typo.h6" Color="Color.Primary">Location Details</MudText>
                    <MudDivider Class="mb-4" />
                </MudItem>

                <MudItem xs="12" sm="3">
                    <MudField Label="Aisle" Variant="Variant.Outlined">
                        @_location.Aisle
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="3">
                    <MudField Label="Section" Variant="Variant.Outlined">
                        @_location.Section
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="3">
                    <MudField Label="Shelf" Variant="Variant.Outlined">
                        @_location.Shelf
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="3">
                    <MudField Label="Bin" Variant="Variant.Outlined">
                        @(_location.Bin ?? "N/A")
                    </MudField>
                </MudItem>

                @* Capacity Information *@
                <MudItem xs="12" Class="mt-4">
                    <MudText Typo="Typo.h6" Color="Color.Primary">Capacity Information</MudText>
                    <MudDivider Class="mb-4" />
                </MudItem>

                <MudItem xs="12" sm="4">
                    <MudField Label="Total Capacity" Variant="Variant.Outlined">
                        @_location.Capacity.ToString("N2") @_location.CapacityUnit
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="4">
                    <MudField Label="Used Capacity" Variant="Variant.Outlined">
                        @_location.UsedCapacity.ToString("N2") @_location.CapacityUnit
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="4">
                    <MudField Label="Available Capacity" Variant="Variant.Outlined">
                        @((_location.Capacity - _location.UsedCapacity).ToString("N2")) @_location.CapacityUnit
                    </MudField>
                </MudItem>

                <MudItem xs="12">
                    @{
                        var percentage = _location.Capacity > 0 ? (_location.UsedCapacity / _location.Capacity) * 100 : 0;
                        var color = GetCapacityColor(_location.UsedCapacity, _location.Capacity);
                    }
                    <MudProgressLinear Color="@color" 
                                       Value="@percentage" 
                                       Size="Size.Large" 
                                       Class="my-2">
                        <MudText Typo="Typo.body2" Color="Color.Dark">
                            @percentage.ToString("F1")% Utilized
                        </MudText>
                    </MudProgressLinear>
                </MudItem>

                @* Temperature Control *@
                @if (_location.RequiresTemperatureControl)
                {
                    <MudItem xs="12" Class="mt-4">
                        <MudText Typo="Typo.h6" Color="Color.Primary">Temperature Control</MudText>
                        <MudDivider Class="mb-4" />
                    </MudItem>

                    <MudItem xs="12" sm="4">
                        <MudField Label="Minimum Temperature" Variant="Variant.Outlined">
                            @(_location.MinTemperature?.ToString("F1") ?? "N/A") @_location.TemperatureUnit
                        </MudField>
                    </MudItem>

                    <MudItem xs="12" sm="4">
                        <MudField Label="Maximum Temperature" Variant="Variant.Outlined">
                            @(_location.MaxTemperature?.ToString("F1") ?? "N/A") @_location.TemperatureUnit
                        </MudField>
                    </MudItem>

                    <MudItem xs="12" sm="4">
                        <MudField Label="Temperature Unit" Variant="Variant.Outlined">
                            @(_location.TemperatureUnit ?? "N/A")
                        </MudField>
                    </MudItem>
                }

                @* Audit Information *@
                <MudItem xs="12" Class="mt-4">
                    <MudText Typo="Typo.h6" Color="Color.Primary">Audit Information</MudText>
                    <MudDivider Class="mb-4" />
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudField Label="Created On" Variant="Variant.Outlined">
                        @_location.CreatedOn.ToString("MMMM dd, yyyy HH:mm")
                    </MudField>
                </MudItem>

                <MudItem xs="12" sm="6">
                    <MudField Label="Last Modified" Variant="Variant.Outlined">
                        @(_location.LastModifiedOn?.ToString("MMMM dd, yyyy HH:mm") ?? "Never")
                    </MudField>
                </MudItem>

                @* Additional Information *@
                @if (!string.IsNullOrWhiteSpace(_location.Notes))
                {
                    <MudItem xs="12" Class="mt-4">
                        <MudText Typo="Typo.h6" Color="Color.Primary">Additional Notes</MudText>
                        <MudDivider Class="mb-4" />
                    </MudItem>

                    <MudItem xs="12">
                        <MudField Label="Notes" Variant="Variant.Outlined" Lines="3">
                            @_location.Notes
                        </MudField>
                    </MudItem>
                }
            </MudGrid>
        }
        else
        {
            <MudAlert Severity="Severity.Warning">Location not found.</MudAlert>
        }
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@Cancel" Color="Color.Default">Close</MudButton>
    </DialogActions>
</MudDialog>

